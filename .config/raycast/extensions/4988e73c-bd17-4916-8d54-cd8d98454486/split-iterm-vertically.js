"use strict";var Y=Object.create;var w=Object.defineProperty;var X=Object.getOwnPropertyDescriptor;var Q=Object.getOwnPropertyNames;var ee=Object.getPrototypeOf,te=Object.prototype.hasOwnProperty;var re=(r,t)=>{for(var e in t)w(r,e,{get:t[e],enumerable:!0})},C=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Q(t))!te.call(r,a)&&a!==e&&w(r,a,{get:()=>t[a],enumerable:!(n=X(t,a))||n.enumerable});return r};var $=(r,t,e)=>(e=r!=null?Y(ee(r)):{},C(t||!r||!r.__esModule?w(e,"default",{value:r,enumerable:!0}):e,r)),ne=r=>C(w({},"__esModule",{value:!0}),r);var be={};re(be,{default:()=>G});module.exports=ne(be);var h=$(require("react")),o=require("@raycast/api");var D=$(require("node:child_process")),M=require("node:buffer"),b=$(require("node:stream")),W=require("node:util");var z=require("react/jsx-runtime");var S=globalThis;var k=r=>!!r&&typeof r=="object"&&typeof r.removeListener=="function"&&typeof r.emit=="function"&&typeof r.reallyExit=="function"&&typeof r.listeners=="function"&&typeof r.kill=="function"&&typeof r.pid=="number"&&typeof r.on=="function",E=Symbol.for("signal-exit emitter"),R=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),S[E])return S[E];Object.defineProperty(S,E,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(t,e){this.listeners[t].push(e)}removeListener(t,e){let n=this.listeners[t],a=n.indexOf(e);a!==-1&&(a===0&&n.length===1?n.length=0:n.splice(a,1))}emit(t,e,n){if(this.emitted[t])return!1;this.emitted[t]=!0;let a=!1;for(let s of this.listeners[t])a=s(e,n)===!0||a;return t==="exit"&&(a=this.emit("afterExit",e,n)||a),a}},T=class{onExit(){return()=>{}}load(){}unload(){}},P=class{#o;#t;#e;#s;#i;#a;#n;#r;constructor(t){this.#o=process.platform==="win32"?"SIGINT":"SIGHUP",this.#t=new R,this.#a={},this.#n=!1,this.#r=[],this.#r.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#r.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#r.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=t,this.#a={};for(let e of this.#r)this.#a[e]=()=>{let n=this.#e.listeners(e),{count:a}=this.#t,s=t;if(typeof s.__signal_exit_emitter__=="object"&&typeof s.__signal_exit_emitter__.count=="number"&&(a+=s.__signal_exit_emitter__.count),n.length===a){this.unload();let i=this.#t.emit("exit",null,e),c=e==="SIGHUP"?this.#o:e;i||t.kill(t.pid,c)}};this.#i=t.reallyExit,this.#s=t.emit}onExit(t,e){if(!k(this.#e))return()=>{};this.#n===!1&&this.load();let n=e?.alwaysLast?"afterExit":"exit";return this.#t.on(n,t),()=>{this.#t.removeListener(n,t),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#n){this.#n=!0,this.#t.count+=1;for(let t of this.#r)try{let e=this.#a[t];e&&this.#e.on(t,e)}catch{}this.#e.emit=(t,...e)=>this.#l(t,...e),this.#e.reallyExit=t=>this.#c(t)}}unload(){this.#n&&(this.#n=!1,this.#r.forEach(t=>{let e=this.#a[t];if(!e)throw new Error("Listener not defined for signal: "+t);try{this.#e.removeListener(t,e)}catch{}}),this.#e.emit=this.#s,this.#e.reallyExit=this.#i,this.#t.count-=1)}#c(t){return k(this.#e)?(this.#e.exitCode=t||0,this.#t.emit("exit",this.#e.exitCode,null),this.#i.call(this.#e,this.#e.exitCode)):0}#l(t,...e){let n=this.#s;if(t==="exit"&&k(this.#e)){typeof e[0]=="number"&&(this.#e.exitCode=e[0]);let a=n.call(this.#e,t,...e);return this.#t.emit("exit",this.#e.exitCode,null),a}else return n.call(this.#e,t,...e)}},A=null,ae=(r,t)=>(A||(A=k(process)?new P(process):new T),A.onExit(r,t));function se(r,{timeout:t}={}){let e=new Promise((c,l)=>{r.on("exit",(d,m)=>{c({exitCode:d,signal:m,timedOut:!1})}),r.on("error",d=>{l(d)}),r.stdin&&r.stdin.on("error",d=>{l(d)})}),n=ae(()=>{r.kill()});if(t===0||t===void 0)return e.finally(()=>n());let a,s=new Promise((c,l)=>{a=setTimeout(()=>{r.kill("SIGTERM"),l(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},t)}),i=e.finally(()=>{clearTimeout(a)});return Promise.race([s,i]).finally(()=>n())}var _=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function ie(r){let{encoding:t}=r,e=t==="buffer",n=new b.default.PassThrough({objectMode:!1});t&&t!=="buffer"&&n.setEncoding(t);let a=0,s=[];return n.on("data",i=>{s.push(i),a+=i.length}),n.getBufferedValue=()=>e?Buffer.concat(s,a):s.join(""),n.getBufferedLength=()=>a,n}async function I(r,t){let e=ie(t);return await new Promise((n,a)=>{let s=i=>{i&&e.getBufferedLength()<=M.constants.MAX_LENGTH&&(i.bufferedData=e.getBufferedValue()),a(i)};(async()=>{try{await(0,W.promisify)(b.default.pipeline)(r,e),n()}catch(i){s(i)}})(),e.on("data",()=>{e.getBufferedLength()>8e7&&s(new _)})}),e.getBufferedValue()}async function O(r,t){r.destroy();try{return await t}catch(e){return e.bufferedData}}async function oe({stdout:r,stderr:t},{encoding:e},n){let a=I(r,{encoding:e}),s=I(t,{encoding:e});try{return await Promise.all([n,a,s])}catch(i){return Promise.all([{error:i,exitCode:null,signal:i.signal,timedOut:i.timedOut||!1},O(r,a),O(t,s)])}}function ce(r){let t=typeof r=="string"?`
`:10,e=typeof r=="string"?"\r":13;return r[r.length-1]===t&&(r=r.slice(0,-1)),r[r.length-1]===e&&(r=r.slice(0,-1)),r}function L(r,t){return r.stripFinalNewline?ce(t):t}function le({timedOut:r,timeout:t,signal:e,exitCode:n}){return r?`timed out after ${t} milliseconds`:e!=null?`was killed with ${e}`:n!=null?`failed with exit code ${n}`:"failed"}function ue({stdout:r,stderr:t,error:e,signal:n,exitCode:a,command:s,timedOut:i,options:c,parentError:l}){let m=`Command ${le({timedOut:i,timeout:c?.timeout,signal:n,exitCode:a})}: ${s}`,y=e?`${m}
${e.message}`:m,v=[y,t,r].filter(Boolean).join(`
`);return e?e.originalMessage=e.message:e=l,e.message=v,e.shortMessage=y,e.command=s,e.exitCode=a,e.signal=n,e.stdout=r,e.stderr=t,"bufferedData"in e&&delete e.bufferedData,e}function fe({stdout:r,stderr:t,error:e,exitCode:n,signal:a,timedOut:s,command:i,options:c,parentError:l}){if(e||n!==0||a!==null)throw ue({error:e,exitCode:n,signal:a,stdout:r,stderr:t,command:i,timedOut:s,options:c,parentError:l});return r}async function V(r,t,e){if(process.platform!=="darwin")throw new Error("AppleScript is only supported on macOS");let{humanReadableOutput:n,language:a,timeout:s,...i}=Array.isArray(t)?e||{}:t||{},c=n!==!1?[]:["-ss"];a==="JavaScript"&&c.push("-l","JavaScript"),Array.isArray(t)&&c.push("-",...t);let l=D.default.spawn("osascript",c,{...i,env:{PATH:"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"}}),d=se(l,{timeout:s??1e4});l.stdin.end(r);let[{error:m,exitCode:y,signal:v,timedOut:K},H,J]=await oe(l,{encoding:"utf8"},d),Z=L({stripFinalNewline:!0},H),q=L({stripFinalNewline:!0},J);return fe({stdout:Z,stderr:q,error:m,exitCode:y,signal:v,timedOut:K,command:"osascript",options:e,parentError:new Error})}var u=require("@raycast/api");var f=require("@raycast/api"),j=$(require("path"));var N=$(require("path"),1);function U(r,t={}){if(typeof r!="string")throw new TypeError(`Expected a string, got ${typeof r}`);let{resolve:e=!0}=t,n=r;return e&&(n=N.default.resolve(r)),n=n.replace(/\\/g,"/"),n[0]!=="/"&&(n=`/${n}`),encodeURI(`file://${n}`).replace(/[?#]/g,encodeURIComponent)}var g=require("react/jsx-runtime"),de=()=>(0,g.jsx)(f.Action.Open,{title:"Open System Preferences",icon:f.Icon.Gear,target:"x-apple.systempreferences:com.apple.preference.security?Privacy_AllFiles"}),he=()=>(0,g.jsx)(f.ActionPanel,{children:(0,g.jsx)(de,{})}),pe=`## Raycast needs automation access to iTerm.

1. Open **System Settings**
1. Open the **Privacy & Security** Preferences pane 
1. Then select the **Automation** tab
1. Expand **Raycast** from the list of applications
1. Ensure the **iTerm**  toggle is enabled as shown in the image below
1. When prompted enter your password

![Full Disk Access Preferences Pane](${U(j.default.join(f.environment.assetsPath,"permission-raycast-automation.png"))})
`,F=r=>r.indexOf("Command failed with exit code 1: osascript -e")!==-1,B=()=>(0,g.jsx)(f.Detail,{markdown:pe,navigationTitle:"Permission Issue with Raycast",actions:(0,g.jsx)(he,{})});var x=require("react"),p=require("react/jsx-runtime"),me=`
  on isAppRunning(appName)
    tell application "System Events" to (name of processes) contains appName
  end isAppRunning

  if isAppRunning("iTerm2") or isAppRunning("iTerm") then
    tell application "iTerm"
      activate
      repeat until application "iTerm" is running
          delay 0.1
      end repeat
      
      tell current session of current window
          split vertically with default profile
      end tell
      activate
    end tell
    return true
  else
    return "iTerm application is not running"
  end if`;function G(){let[r,t]=(0,x.useState)(!1),e=()=>{V(me).then(async n=>{n!=="true"&&await(0,u.showHUD)(n),await(0,u.closeMainWindow)(),await(0,u.popToRoot)()}).catch(async n=>{if(F(n.message)){t(!0);return}await(0,u.showToast)({style:u.Toast.Style.Failure,title:"Cannot split vertically",message:n.message})})};return(0,x.useEffect)(()=>{e()},[]),(0,p.jsxs)(p.Fragment,{children:[r&&(0,p.jsx)(B,{}),!r&&(0,p.jsx)(u.Detail,{isLoading:!0,navigationTitle:"Splitting iTerm...",markdown:"Splitting iTerm..."})]})}
